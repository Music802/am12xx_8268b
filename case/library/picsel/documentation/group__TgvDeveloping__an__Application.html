<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>File Viewer Development Kit: Developing an Application</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="entwrx.css" rel="stylesheet" type="text/css"></head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="sot-logo-small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">File Viewer Development Kit
   &#160;<span id="projectnumber">trunk</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#groups">Modules</a>  </div>
  <div class="headertitle">
<div class="title">Developing an Application</div>  </div>
<div class="ingroups"><a class="el" href="group__TgvIntegration.html">TgvIntegration</a></div></div><!--header-->
<div class="contents">

<p>TGV is a sophisticated and flexible system, which works on many operating systems, and provides far more features than a single device will require.
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__Main__Tgv__Functions"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Main__Tgv__Functions.html">Main TGV Functions</a></td></tr>
<tr class="memdesc:group__Main__Tgv__Functions"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main TGV Functions. <br/></td></tr>
<tr class="memitem:group__TgvExampleFiles"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TgvExampleFiles.html">Example Files</a></td></tr>
<tr class="memdesc:group__TgvExampleFiles"><td class="mdescLeft">&#160;</td><td class="mdescRight">&#160; <br/></td></tr>
<tr class="memitem:group__TgvDeveloping__a__FileViewer"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TgvDeveloping__a__FileViewer.html">Developing a File Viewer Application</a></td></tr>
<tr class="memdesc:group__TgvDeveloping__a__FileViewer"><td class="mdescLeft">&#160;</td><td class="mdescRight">&#160; <br/></td></tr>
</table>
<a name="details" id="details"></a><h2>Detailed Description</h2>
<p>TGV is a sophisticated and flexible system, which works on many operating systems, and provides far more features than a single device will require. </p>
<p>The integration process is broadly divided into five parts:</p>
<ul>
<li>Planning the product.</li>
<li>Porting the platform interfaces to the operating system.</li>
<li>Designing the user interface.</li>
<li>Configuring the optional parts.</li>
<li>Testing the product.</li>
</ul>
<p>This section outlines how to integrate a TGV product onto your device, for example integrating File Viewer Development Kit (FVDK) on a mobile telephone handset. The intended audience of this guide are customer engineers at an OEM, tasked with carrying out the integration work. It is expected that a customer engineer performing the integration will have:</p>
<ul>
<li>a good understanding of the C programming language</li>
<li>a good understanding of the target device (including knowledge of the OS, compilers and debugging tools)</li>
<li>understanding of general computing principles such as threading.</li>
</ul>
<h1><a class="anchor" id="TgvDeveloping_App_Examine"></a>
Examine the TGV Delivery</h1>
<p>First, please read this document before beginning the integration work itself. Look at the source code provided, run the Windows sample application, and understand the features, before writing your own code.</p>
<h1><a class="anchor" id="TgvDeveloping_App_Sample"></a>
Choose a Sample Application</h1>
<p>Use a ENTWRX sample application similar to your handset platform from the choice in the TGV package (For example Symbian Series 60). It is possible, if necessary, to write a completely new application. See the section for the most relevant application type, linked from the bottom of this page, for examples, or <a class="el" href="group__TgvExampleFiles.html">Example Files</a>.</p>
<h1><a class="anchor" id="TgvDeveloping_App_Implement"></a>
Implementing the API</h1>
<p>The task of the Alien application developer is in two parts:</p>
<ul>
<li>You must write functions to provide platform and OS features to the SecureWrx library.</li>
<li>You must call functions to use the services provided by the SecureWrx library.</li>
</ul>
<p>In general, functions of the first type are prefixed "Alien", and those of the second "Picsel".</p>
<p>Some Alien functions can be omitted or stubbed, as described in each function description. The documentation of each function indicates which TGV products it is needed for. Depending on how similar your device is to Picsel's sample application platform, it may be possible to re-use a large part of Picsel's sample application code. The major API functions are briefly described in the <a class="el" href="group__Main__Tgv__Functions.html">Main TGV Functions</a> section. For Alien functions that are only implemented as stubs, you should return a suitable error code and output a message in debug builds to allow you to easily see where you still have work to do. You may find it useful to assert(false) in functions which you do not expect to be called by the SecureWrx library.</p>
<h1><a class="anchor" id="TgvDeveloping_a_Specific_Application"></a>
Developing a Specific Application</h1>
<p>Each ENTWRX TGV product requires an Alien application that implements the basic TGV features, but each will require a different subset of the Alien functions to be implemented in the Alien application. Please implement the standard TGV functions described below, and then read the section for your product, using the links in the list of "Modules", below.</p>
<h1><a class="anchor" id="TgvDeveloping_App_Flow"></a>
The Main Flow of Control</h1>
<h2><a class="anchor" id="TgvDeveloping_App_Init"></a>
Application Initialisation</h2>
<p>The main sequence of event during initialisation of an application built using a TGV library is as follows. This varies somewhat for other products (see TgvProducts).</p>
<ul>
<li>The Alien application will be started, perhaps from a menu selection or by running an application, or by choosing a file for which the TGV product is the registered handler.</li>
<li>PicselApp_start() should be called with the proper TGV product's initialisation function as a parameter, for example Picsel_EntryPoint_FileViewer.</li>
<li>The SecureWrx library is likely to call AlienTimer_request(), and return from PicselApp_start(). The Alien application should call PicselApp_timerExpiry() when appropriate. This is the main way in which the SecureWrx library gains and yields control of the device CPU.</li>
<li>The SecureWrx library will call AlienConfig_ready(). This function in the Alien application should set any desired configuration properties, typically using PicselConfig_setInt(). Examples include setting the threading time slices, using PicselApp_setTimeSlice(). It may also call configuration functions such as Picsel_Font_Register_jajp() to activate support for languages and character sets, see TgvLanguageInit for further information.</li>
<li>In AlienConfig_ready() you should also set any product-specific configurations necessary. See the page for your product linked from the list of "Modules" below.</li>
<li>The SecureWrx library will call AlienScreen_getConfiguration() to prepare its display buffer.</li>
<li>The SecureWrx library will call AlienEvent_information() with AlienInformation_InitComplete to confirm that it has started successfully.</li>
<li>The application should enter a loop to handle keystroke and timer events until the user instructs it to exit. Keystrokes are typically sent to the SecureWrx library using PicselApp_keyPress(), or, for more advanced commands, with special functions such as PicselFlowMode_set().</li>
<li>How the keystrokes are handled will vary depending on the specific product being integrated. See the page for your product linked from the list of "Modules" below.</li>
</ul>
<p><div class="dotgraph">
<img src="dot_main-flow-startup.png" alt="dot_main-flow-startup.png" border="0" usemap="#dot_main-flow-startup.map"/>
<map name="dot_main-flow-startup.map" id="dot_main-flow-startup.map"><area shape="rect" href="" coords="245,60,356,73"><area shape="rect" href="" coords="233,102,367,115"><area shape="rect" href="" coords="222,186,378,199"><area shape="rect" href="" coords="236,228,364,241"><area shape="rect" href="" coords="233,270,367,283"><area shape="rect" href="" coords="222,312,378,325"><area shape="rect" href="" coords="205,354,395,367"><area shape="rect" href="" coords="210,396,390,409"><area shape="rect" href="" coords="199,480,401,493"><area shape="rect" href="" coords="203,522,397,535"><area shape="rect" href="" coords="233,564,367,577"></map>
</div>
</p>
<h2><a class="anchor" id="TgvDeveloping_App_Cont_Operation"></a>
Continuing Operation</h2>
<p>The ongoing flow of control for an application built using a TGV library is as follows. This varies for other products (see TgvProducts), but rather less so than does initialisation.</p>
<ul>
<li>From time to time, the SecureWrx library will call platform interface functions such as AlienFile_open().</li>
<li>From time to time, the SecureWrx library will call AlienScreen_update() with a new image to display. This is the main output. The times at which this happens will depend on many circumstances.</li>
<li>The key and event handling loop should continue. Be sure to properly handle system events such as requests to pause the application, by suspending the SecureWrx library with PicselApp_suspend().</li>
<li>The SecureWrx library will request timers repeatedly, and perform its main processing within PicselApp_timerExpiry().</li>
<li>When exiting, the Alien application should call PicselApp_shutDown().</li>
</ul>
<p><div class="dotgraph">
<img src="dot_main-flow-normal-operation.png" alt="dot_main-flow-normal-operation.png" border="0" usemap="#dot_main-flow-normal-operation.map"/>
<map name="dot_main-flow-normal-operation.map" id="dot_main-flow-normal-operation.map"><area shape="rect" href="" coords="233,89,367,102"><area shape="rect" href="" coords="229,173,371,186"><area shape="rect" href="" coords="229,215,371,228"><area shape="rect" href="" coords="222,257,378,270"><area shape="rect" href="" coords="230,299,370,312"><area shape="rect" href="" coords="248,341,353,354"><area shape="rect" href="" coords="230,383,370,396"><area shape="rect" href="" coords="230,425,370,438"><area shape="rect" href="" coords="229,467,371,480"><area shape="rect" href="" coords="230,509,370,522"><area shape="rect" href="" coords="233,551,367,564"></map>
</div>
</p>
<h2><a class="anchor" id="TgvDevelopingSpecificProduct"></a>
Applying these instructions to a specific TGV Product.</h2>
<p>The above general instructions describe the steps common to most TGV products. Each product will expand and/or over-ride these steps as described in its developing guide. See <a href="index.html">Main Page</a> for the product you are developing for a link to its developing/porting guide, or follow the links in "Modules" section below.</p>
<h1><a class="anchor" id="TgvDeveloping_App_Link"></a>
Link with the SecureWrx library</h1>
<p>Your Alien application will have external dependencies which are satisfied by the SecureWrx library, and vice-versa. The library will fail to link if any required Alien functions have not been implemented, or if you call ENTWRX functions that are not included in your delivery.</p>
<p>Some sections of the library will be omitted during linking, if they are not required. For example, Picsel_Font_Register_jajp() contains an internal dependency on a static data structure of font glyphs and character encodings. If the Alien application does not call it, that data will not be linked. See <a class="el" href="group__TgvLink__Time__Configuration.html">Link Time Configuration</a>.</p>
<p>ENTWRX changes the names of other non-public functions and symbols to unusual ones, so it is very unlikely that there will be a conflict between the SecureWrx library and any other software on your device, even if similar code is already used on the device (for example some image processing or data compression libraries that might be widely used).</p>
<p>Please do not attempt to integrate two separate ENTWRX SDKs on the same device (such as Photo Lab and File Viewer Development Kits). ENTWRX can provide a single combined version, and you can implement several Alien applications that call PicselApp_start() with different entry points. The shared parts of the TGV core will benefit from this.</p>
<p>The link should result in an executable ready to be run and debugged.</p>
<h1><a class="anchor" id="TgvDeveloping_App_Debug"></a>
Debug the Application on the target Device</h1>
<p>The basic application should be run and debugged on an emulator, and then on the target device. It should be possible to use and interact with it normally, and enjoyably. For example, a File Viewer should load and view files in each of the required formats displaying the correct fonts for the required languages.</p>
<p>If you find behaviour of the SecureWrx library that you would like ENTWRX to change, please inform your ENTWRX support representative.</p>
<h1><a class="anchor" id="TgvDeveloping_App_Test"></a>
Test the System</h1>
<p>The system should be tested for normal use, error conditions, and real-time issues. This should include:</p>
<ul>
<li>Check the phone can ring while a document is being loaded.</li>
<li>Check an error message is displayed when a corrupt document is loaded.</li>
<li>Check documents can be displayed in each of the appropriate languages.</li>
<li>ENTWRX Gold Master validation tests, described below.</li>
<li>Other tests of your choice.</li>
</ul>
<p>If you find a bug which you believe to be in the SecureWrx library, please also test on the Windows version of the application, then report it, in detail, to ENTWRX using the on-line issue tracking system.</p>
<p>The completed application should be sent to ENTWRX for Gold Master validation testing and approval. ENTWRX will also require hardware for this.</p>
<h1><a class="anchor" id="TgvDeveloping_App_Optimise"></a>
Optimise the Performance</h1>
<p>The following points should be considered once a basic application is running in order to improve performance and memory.</p>
<ul>
<li>Unnecessary document agents, fonts or encodings should not be registered in AlienConfig_ready(). This will reduce the footprint of the final application.</li>
<li>Set the time-slice appropriately so that other features on your device can operate satisfactorily, for example receiving telephone calls. Some OS's have a watchdog timer that kills applications that do not yield control within 250ms.</li>
<li>Ensure the most critical functions run quickly, for example AlienTimer_getUptime() and AlienScreen_update().</li>
<li>Set a pan and zoom repeat step such that the pan and zoom occur at a reasonable rate for the speed of the target device.</li>
<li>Send key-release events to the SecureWrx library by calling PicselApp_keyRelease() after configuring it with PicselApp_setKeyBehaviour(). Although this is not mandatory, performance will be much smoother by using key-release events.</li>
<li>The key auto repeat rate (PicselConfig_keyAutorepeatRate) can be set to find the best balance between the responsiveness of the application and controlling the number of key events that are processed. This can be done by setting the PicselConfig_keyAutorepeatRate parameter using PicselConfig_setInt().</li>
<li>Review every configurable option and set them appropriately using PicselConfig_setInt() and PicselConfig_setString(). See TgvConfigureCore.</li>
</ul>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__Main__Tgv__Functions.html">Main TGV Functions</a> </dd></dl>
</div><!-- contents -->
<hr size="1"><address style="align: right;"><small>
<img src="securewrx-logo-small.png" align=right>
Copyright &copy; <a href="http://www.entwrx.com/">ENTWRX Ltd</a> 2014.
All rights reserved.
Generated on Thu Jul 2 2015 for File Viewer Development Kit trunk by
<a href="http://www.doxygen.org/">Doxygen</a>.</small></address>
<!-- Footer $Id: doxy-footer.html,v 1.4.10.1 2014/06/06 11:55:46 andrews Exp $ -->
</body>
</html>
